<!doctype html>
<html lang="ko" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Spring Bootì—ì„œ Session ì¸ì¦ì„ ì»¤ìŠ¤í…€í•˜ëŠ” ì´ìœ ì™€ ì‹¤ì „ êµ¬í˜„ | ì‹ ê°•í¬ | Backend Developer</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://KKangHHee.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://KKangHHee.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://KKangHHee.github.io/blog/spring-boot-custom-session-authentication"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Spring Bootì—ì„œ Session ì¸ì¦ì„ ì»¤ìŠ¤í…€í•˜ëŠ” ì´ìœ ì™€ ì‹¤ì „ êµ¬í˜„ | ì‹ ê°•í¬ | Backend Developer"><meta data-rh="true" name="description" content="&quot;ì™œ Spring Securityì˜ ê¸°ë³¸ Form Loginì„ ì“°ì§€ ì•Šê³  ì§ì ‘ êµ¬í˜„í• ê¹Œ?&quot;"><meta data-rh="true" property="og:description" content="&quot;ì™œ Spring Securityì˜ ê¸°ë³¸ Form Loginì„ ì“°ì§€ ì•Šê³  ì§ì ‘ êµ¬í˜„í• ê¹Œ?&quot;"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-04-15T00:00:00.000Z"><link data-rh="true" rel="canonical" href="https://KKangHHee.github.io/blog/spring-boot-custom-session-authentication"><link data-rh="true" rel="alternate" href="https://KKangHHee.github.io/blog/spring-boot-custom-session-authentication" hreflang="ko"><link data-rh="true" rel="alternate" href="https://KKangHHee.github.io/blog/spring-boot-custom-session-authentication" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://KKangHHee.github.io/blog/spring-boot-custom-session-authentication","mainEntityOfPage":"https://KKangHHee.github.io/blog/spring-boot-custom-session-authentication","url":"https://KKangHHee.github.io/blog/spring-boot-custom-session-authentication","headline":"Spring Bootì—ì„œ Session ì¸ì¦ì„ ì»¤ìŠ¤í…€í•˜ëŠ” ì´ìœ ì™€ ì‹¤ì „ êµ¬í˜„","name":"Spring Bootì—ì„œ Session ì¸ì¦ì„ ì»¤ìŠ¤í…€í•˜ëŠ” ì´ìœ ì™€ ì‹¤ì „ êµ¬í˜„","description":"\"ì™œ Spring Securityì˜ ê¸°ë³¸ Form Loginì„ ì“°ì§€ ì•Šê³  ì§ì ‘ êµ¬í˜„í• ê¹Œ?\"","datePublished":"2025-04-15T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://KKangHHee.github.io/blog","name":"Troubleshooting & Learning"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ì‹ ê°•í¬ | Backend Developer RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ì‹ ê°•í¬ | Backend Developer Atom Feed"><link rel="stylesheet" href="/assets/css/styles.00259b7c.css">
<script src="/assets/js/runtime~main.1fabbc67.js" defer="defer"></script>
<script src="/assets/js/main.2045941f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°</a></div><nav aria-label="ë©”ì¸" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="ì‚¬ì´ë“œë°” í¼ì¹˜ê±°ë‚˜ ì ‘ê¸°" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Kang-hee.log</b></a><a class="navbar__item navbar__link" href="/resume">ğŸ“„ Resume</a><a class="navbar__item navbar__link" href="/docs/projects/">ğŸ“ Projects</a><a class="navbar__item navbar__link" href="/blog/index">âœï¸ Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/KKangHHee" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="ì–´ë‘ìš´ ëª¨ë“œì™€ ë°ì€ ëª¨ë“œ ì „í™˜í•˜ê¸° (í˜„ì¬ system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1"><article class=""><header><h1 class="title_f1Hy">Spring Bootì—ì„œ Session ì¸ì¦ì„ ì»¤ìŠ¤í…€í•˜ëŠ” ì´ìœ ì™€ ì‹¤ì „ êµ¬í˜„</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-04-15T00:00:00.000Z">2025ë…„ 4ì›” 15ì¼</time></div></header><div id="__blog-post-container" class="markdown"><blockquote>
<p>&quot;ì™œ Spring Securityì˜ ê¸°ë³¸ Form Loginì„ ì“°ì§€ ì•Šê³  ì§ì ‘ êµ¬í˜„í• ê¹Œ?&quot;</p>
</blockquote>
<p>ì´ ê¸€ì—ì„œëŠ” <strong>Admin/Customer í†µí•© í™˜ê²½</strong>ì—ì„œ <strong>JSON ê¸°ë°˜ ë¡œê·¸ì¸ + ì¤‘ë³µ ë¡œê·¸ì¸ ì œì–´</strong>ë¥¼ êµ¬í˜„í•˜ë©° ê²ªì—ˆë˜ <strong>í‘œì¤€ ë°©ì‹ìœ¼ë¡œëŠ” ì•ˆ ë˜ëŠ” ì´ìœ </strong>ì™€ <strong>ì–´ë–»ê²Œ ìš°íšŒí–ˆëŠ”ì§€</strong>ë¥¼ ê¸°ë¡í•©ë‹ˆë‹¤.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-ì™œ-ì»¤ìŠ¤í…€-ì„¸ì…˜-ì¸ì¦">1. ì™œ ì»¤ìŠ¤í…€ ì„¸ì…˜ ì¸ì¦?<a href="#1-ì™œ-ì»¤ìŠ¤í…€-ì„¸ì…˜-ì¸ì¦" class="hash-link" aria-label="1. ì™œ ì»¤ìŠ¤í…€ ì„¸ì…˜ ì¸ì¦?ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="1. ì™œ ì»¤ìŠ¤í…€ ì„¸ì…˜ ì¸ì¦?ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="í”„ë¡œì íŠ¸-ìš”êµ¬ì‚¬í•­">í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­<a href="#í”„ë¡œì íŠ¸-ìš”êµ¬ì‚¬í•­" class="hash-link" aria-label="í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<table><thead><tr><th>í•­ëª©</th><th>ìš”êµ¬ì‚¬í•­</th><th>í‘œì¤€ FormLogin ê°€ëŠ¥ ì—¬ë¶€</th></tr></thead><tbody><tr><td><strong>JSON ê¸°ë°˜ ë¡œê·¸ì¸</strong></td><td><code>{&quot;email&quot;: &quot;...&quot;, &quot;password&quot;: &quot;...&quot;}</code></td><td>ë³µì¡</td></tr><tr><td><strong>ì¤‘ë³µ ë¡œê·¸ì¸ ì œì–´</strong></td><td>ë™ì¼ ê³„ì • 1ëª…ë§Œ ë¡œê·¸ì¸ í—ˆìš©</td><td>ê°€ëŠ¥</td></tr><tr><td><strong>ê³„ì • ì ê¸ˆ ì²˜ë¦¬</strong></td><td>5íšŒ ì‹¤íŒ¨ ì‹œ ê³„ì • ì ê¹€</td><td>ì»¤ìŠ¤í…€ í•„ìš”</td></tr><tr><td><strong>ì²« ë¡œê·¸ì¸ ì²´í¬</strong></td><td>ì²« ë¡œê·¸ì¸ ì‹œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ê°•ì œ</td><td>ì»¤ìŠ¤í…€ í•„ìš”</td></tr><tr><td><strong>íƒ€ì…ë³„ ì‘ë‹µ</strong></td><td>Admin/Customerë³„ ë‹¤ë¥¸ ì‘ë‹µ</td><td>ì»¤ìŠ¤í…€ í•„ìš”</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="í‘œì¤€-formloginì˜-í•œê³„">í‘œì¤€ FormLoginì˜ í•œê³„<a href="#í‘œì¤€-formloginì˜-í•œê³„" class="hash-link" aria-label="í‘œì¤€ FormLoginì˜ í•œê³„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="í‘œì¤€ FormLoginì˜ í•œê³„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<p><strong>Spring Securityì˜ ê¸°ë³¸ FormLogin í•„í„° ì²´ì¸:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">UsernamePasswordAuthenticationFilter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†’ AuthenticationManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†’ UserDetailsService (ì‚¬ìš©ì ì¡°íšŒ)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†’ SuccessHandler / FailureHandler</span><br></span></code></pre></div></div>
<p><strong>ë¬¸ì œì :</strong></p>
<ol>
<li class=""><strong>í•„í„° ë‹¨ê³„ì—ì„œëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì£¼ì…ì´ ë³µì¡</strong>
<ul>
<li class="">í•„í„° ê¸°ë°˜ ì¸ì¦ì€ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ì–´ë µê³ , íŠ¹íˆ AuthenticationFailureHandlerë§Œìœ¼ë¡œëŠ” DB ìƒíƒœ ë³€ê²½(ì ê¸ˆ ë“±)ì„ ì²˜ë¦¬í•˜ê¸° ì§ê´€ì ì´ì§€ ì•ŠìŒ.</li>
</ul>
</li>
<li class=""><strong>ì‹¤íŒ¨ ì¹´ìš´íŠ¸ë¥¼ ì–´ë””ì„œ ê´€ë¦¬í• ê¹Œ?</strong>
<ul>
<li class="">í•„í„°ëŠ” Statelessí•˜ë¯€ë¡œ DB ì—…ë°ì´íŠ¸ ë¡œì§ì„ ë¼ì›Œë„£ê¸° ì• ë§¤í•¨</li>
</ul>
</li>
<li class=""><strong>ì²« ë¡œê·¸ì¸ ì²´í¬ëŠ” ì¸ì¦ ì„±ê³µ ì´í›„ì— íŒë‹¨í•´ì•¼ í•¨</strong>
<ul>
<li class="">í•„í„° ì²´ì¸ì—ì„œëŠ” ìˆœì„œìƒ ì–´ìƒ‰í•¨</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="í•´ê²°-ë°©ì•ˆ-controller--sessionauthenticationstrategy-ì¡°í•©">í•´ê²° ë°©ì•ˆ: Controller + SessionAuthenticationStrategy ì¡°í•©<a href="#í•´ê²°-ë°©ì•ˆ-controller--sessionauthenticationstrategy-ì¡°í•©" class="hash-link" aria-label="í•´ê²° ë°©ì•ˆ: Controller + SessionAuthenticationStrategy ì¡°í•©ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="í•´ê²° ë°©ì•ˆ: Controller + SessionAuthenticationStrategy ì¡°í•©ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<blockquote>
<p>í•„í„°ë¥¼ ìš°íšŒí•˜ì—¬ Controllerì—ì„œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì„ í–‰ ì²˜ë¦¬í•˜ë˜,
ì¸ì¦ ê²°ê³¼ëŠ” Securityì˜ í‘œì¤€ ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ìš©í•´ ì„¸ì…˜ ì‹œìŠ¤í…œì— ë“±ë¡
ìˆ˜ë™ìœ¼ë¡œ Authentication ê°ì²´ë¥¼ ìƒì„±í•˜ê³ ,
SecurityContextRepositoryë¥¼ í†µí•´ ì„¸ì…˜ì— ì˜ì†í™”í•˜ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì„ ì½”ë“œë¡œ êµ¬í˜„</p>
</blockquote>
<p><strong>[ê¸°ì¡´] Filter Chain ë°©ì‹</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Request â†’ Filter â†’ AuthenticationManager â†’ Response</span><br></span></code></pre></div></div>
<p><strong>[ê°œì„ ] Controller ë°©ì‹</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Request â†’ Controller â†’ Service (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†’ ìˆ˜ë™ìœ¼ë¡œ AuthenticationManager í˜¸ì¶œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†’ SessionAuthenticationStrategy í˜¸ì¶œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†’ SecurityContext ì €ì¥ â†’ Response</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Spring Securityì˜ ì„¸ì…˜ ì •ì±…ì„ ê·¸ëŒ€ë¡œ í™œìš©í•˜ëŠ” ë°©ì•ˆ</strong></p>
</blockquote>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-ì¸ì¦-êµ¬í˜„">2. ì¸ì¦ êµ¬í˜„<a href="#2-ì¸ì¦-êµ¬í˜„" class="hash-link" aria-label="2. ì¸ì¦ êµ¬í˜„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="2. ì¸ì¦ êµ¬í˜„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ì „ì²´-ì¸ì¦-í”Œë¡œìš°">ì „ì²´ ì¸ì¦ í”Œë¡œìš°<a href="#ì „ì²´-ì¸ì¦-í”Œë¡œìš°" class="hash-link" aria-label="ì „ì²´ ì¸ì¦ í”Œë¡œìš°ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="ì „ì²´ ì¸ì¦ í”Œë¡œìš°ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. [Client] Request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. [Controller] ìš”ì²­ ìˆ˜ì‹ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. [LoginService] ê²€ì¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		3.1 ì‚¬ìš©ì í™•ì¸</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		3.2 ê³„ì • í™œì„± ì—¬ë¶€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		3.3 ë¹„ë°€ë²ˆí˜¸ ê²€ì¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		3.4 ì²« ë¡œê·¸ì¸ ê²€ì¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. [performSecurityAuthentication]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		4.1 AuthenticationManager.authenticate() í˜¸ì¶œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		4.2 SessionAuthenticationStrategy.onAuthentication() í˜¸ì¶œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">				4.2.1) ì¤‘ë³µ ì„¸ì…˜ ì œì–´ | ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì§€ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">				4.2.2) SessionRegistry ë“±ë¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		4.3 SecurityContext ìƒì„± ë° ì„¤ì •</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		4.4 HttpSessionì— SecurityContext ì €ì¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. [Response]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ë‹¨ê³„ë³„-ì„¤ëª…">ë‹¨ê³„ë³„ ì„¤ëª…<a href="#ë‹¨ê³„ë³„-ì„¤ëª…" class="hash-link" aria-label="ë‹¨ê³„ë³„ ì„¤ëª…ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="ë‹¨ê³„ë³„ ì„¤ëª…ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<p><strong>1ë‹¨ê³„: ì‚¬ìš©ì ìš”ì²­ ìˆ˜ì‹ </strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@PostMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/login&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">ResponseEntity</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token annotation punctuation" style="color:#393A34">@RequestBody</span><span class="token plain"> </span><span class="token class-name">LoginDto</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Controllerì—ì„œ ì§ì ‘ ì²˜ë¦¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>2ë‹¨ê³„: ë¹„ì¦ˆë‹ˆìŠ¤ ê²€ì¦ (LoginService)</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isLocked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">AccountLockedException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isFirstLogin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FirstLoginResponse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì„¸ìš”.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">passwordEncoder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">incrementFailCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getFailCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    userRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">save</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">BadCredentialsException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ í‹€ë ¸ìŠµë‹ˆë‹¤.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>3ë‹¨ê³„: Spring Security ì¸ì¦ ì‹¤í–‰</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// AuthenticationManagerë¥¼ ìˆ˜ë™ìœ¼ë¡œ í˜¸ì¶œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token plain"> authToken </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getEmail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getAuthorities</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Authentication</span><span class="token plain"> authentication </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> authenticationManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">authenticate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>4ë‹¨ê³„: ì„¸ì…˜ ì •ì±… ì ìš©</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// SessionAuthenticationStrategy ìˆ˜ë™ í˜¸ì¶œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sessionAuthenticationStrategy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onAuthentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authentication</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>5ë‹¨ê³„: SecurityContext ì €ì¥</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">SecurityContext</span><span class="token plain"> context </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> securityContextHolderStrategy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createEmptyContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setAuthentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authentication</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">SecurityContextHolder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securityContextRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">saveContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-í•µì‹¬-ì»´í¬ë„ŒíŠ¸-êµ¬í˜„">3. í•µì‹¬ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„<a href="#3-í•µì‹¬-ì»´í¬ë„ŒíŠ¸-êµ¬í˜„" class="hash-link" aria-label="3. í•µì‹¬ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="3. í•µì‹¬ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ê°-ì»´í¬ë„ŒíŠ¸ì˜-ì—­í• "><strong>ê° ì»´í¬ë„ŒíŠ¸ì˜ ì—­í• </strong><a href="#ê°-ì»´í¬ë„ŒíŠ¸ì˜-ì—­í• " class="hash-link" aria-label="ê°-ì»´í¬ë„ŒíŠ¸ì˜-ì—­í• ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="ê°-ì»´í¬ë„ŒíŠ¸ì˜-ì—­í• ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<table><thead><tr><th>ì»´í¬ë„ŒíŠ¸</th><th>ì—­í• </th><th>ì‹¤ë¬´ ì˜ë¯¸</th></tr></thead><tbody><tr><td><code>HttpSessionEventPublisher</code></td><td>ì„¸ì…˜ ìƒì„±/ì‚­ì œ ì´ë²¤íŠ¸ë¥¼ Spring Securityì— ì „ë‹¬</td><td>ë¡œê·¸ì•„ì›ƒ/íƒ€ì„ì•„ì›ƒ ì‹œ SessionRegistry ìë™ ì •ë¦¬</td></tr><tr><td><code>SessionRegistry</code></td><td>ì„¸ì…˜ ë° ì‚¬ìš©ì ìƒíƒœ ê´€ë¦¬</td><td>Admin UIì—ì„œ &quot;í˜„ì¬ ì ‘ì† ì¤‘ì¸ ì‚¬ìš©ì&quot; ëª©ë¡ í™•ì¸ ê°€ëŠ¥</td></tr><tr><td><code>SessionAuthenticationStrategy</code></td><td>ì„¸ì…˜ ì •ì±… ì²´ì¸</td><td>ì¤‘ë³µ ë¡œê·¸ì¸ ì œì–´ + ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì§€ + ì„¸ì…˜ ë“±ë¡</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-user-entity">1) User Entity<a href="#1-user-entity" class="hash-link" aria-label="1) User Entityì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="1) User Entityì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;users&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@EqualsAndHashCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">of </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> callSuper </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@NoArgsConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">access </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AccessLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PROTECTED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">User</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">UserDetails</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="equalshashcodeë¥¼-ì˜¤ë²„ë¼ì´ë”©-í•˜ëŠ”-ì´ìœ "><code>equals</code>/<code>hashCode</code>ë¥¼ ì˜¤ë²„ë¼ì´ë”© í•˜ëŠ” ì´ìœ <a href="#equalshashcodeë¥¼-ì˜¤ë²„ë¼ì´ë”©-í•˜ëŠ”-ì´ìœ " class="hash-link" aria-label="equalshashcodeë¥¼-ì˜¤ë²„ë¼ì´ë”©-í•˜ëŠ”-ì´ìœ ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="equalshashcodeë¥¼-ì˜¤ë²„ë¼ì´ë”©-í•˜ëŠ”-ì´ìœ ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h4>
<ul>
<li class="">
<p>Spring Securityì˜ <code>SessionRegistry</code>ëŠ” <strong>ë™ì¼ ì‚¬ìš©ìì˜ ì„¸ì…˜ì„ ì¶”ì </strong>í•˜ê¸° ìœ„í•´</p>
</li>
<li class="">
<p>ë‚´ë¶€ì ìœ¼ë¡œ <code>Map&lt;Object, Set&lt;SessionInformation&gt;&gt;</code>ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— <code>equals</code>/<code>hashCode</code>ë¥¼ ì˜¤ë²„ë¼ì´ë”©í•´ í•´ì•¼ í•¨</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// SessionRegistryImpl ë‚´ë¶€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">ConcurrentMap</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> principals </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ConcurrentHashMap</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">registerNewSession</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> sessionId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Object</span><span class="token plain"> principal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Set</span><span class="token plain"> sessions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> principals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">principal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ì—¬ê¸°ì„œ principal.equals()ë¡œ ë™ì¼ ì‚¬ìš©ì íŒë‹¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><code>equals</code>ë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì§€ ì•Šìœ¼ë©´: <strong>ê°ì²´ ì°¸ì¡° ë¹„êµ</strong>ë¡œ ë™ì‘</p>
</li>
<li class="">
<p>SessionRegistryì— ê°™ì€ ì‚¬ìš©ìê°€ ì—¬ëŸ¬ ë²ˆ ë“±ë¡ë˜ì–´, ì¤‘ë³µ ë¡œê·¸ì¸ ì œì–´ X</p>
</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-loginservice">2) LoginService<a href="#2-loginservice" class="hash-link" aria-label="2) LoginServiceì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="2) LoginServiceì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-ë¡œê·¸ì¸-ë©”ì¸-ë¡œì§">1) ë¡œê·¸ì¸ ë©”ì¸ ë¡œì§<a href="#1-ë¡œê·¸ì¸-ë©”ì¸-ë¡œì§" class="hash-link" aria-label="1) ë¡œê·¸ì¸ ë©”ì¸ ë¡œì§ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="1) ë¡œê·¸ì¸ ë©”ì¸ ë¡œì§ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Transactional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">LoginResponse</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">LoginDto</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">HttpServletRequest</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token class-name">HttpServletResponse</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 1. ì‚¬ìš©ì ì¡°íšŒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">User</span><span class="token plain"> user </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> userRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">findByEmail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getEmail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">orElseThrow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UsernameNotFoundException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 2. ê³„ì • ì ê¹€ ì²´í¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isLocked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">AccountLockedException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 3. ê³„ì • í™œì„±í™” ì²´í¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">DisabledException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ë¹„í™œì„±í™”ëœ ê³„ì •ì…ë‹ˆë‹¤.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 4. ë¹„ë°€ë²ˆí˜¸ ê²€ì¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">passwordEncoder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">incrementFailCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            userRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">save</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isLocked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">AccountLockedException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;5íšŒ ì‹¤íŒ¨ë¡œ ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">BadCredentialsException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. (ë‚¨ì€ ì‹œë„: %díšŒ)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getFailCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 5. ì²« ë¡œê·¸ì¸ ì²´í¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isFirstLogin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">LoginResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">firstLogin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 6. Spring Security ì¸ì¦ ì‹¤í–‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">performSecurityAuthentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 7. ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">resetFailCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">save</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">LoginResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">success</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-spring-security-ì¸ì¦-ìˆ˜í–‰">2) Spring Security ì¸ì¦ ìˆ˜í–‰<a href="#2-spring-security-ì¸ì¦-ìˆ˜í–‰" class="hash-link" aria-label="2) Spring Security ì¸ì¦ ìˆ˜í–‰ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="2) Spring Security ì¸ì¦ ìˆ˜í–‰ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">performSecurityAuthentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">LoginDto</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">User</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                </span><span class="token class-name">HttpServletRequest</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                </span><span class="token class-name">HttpServletResponse</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 1. AuthenticationManagerë¥¼ í†µí•œ ì¸ì¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token plain"> authToken </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getEmail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getAuthorities</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Authentication</span><span class="token plain"> authentication </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> authenticationManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">authenticate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 2. SessionAuthenticationStrategy í˜¸ì¶œ (ì„¸ì…˜ ì •ì±… ì ìš©) â†’ SessionRegistry ë“±ë¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sessionAuthenticationStrategy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onAuthentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authentication</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 3. SecurityContext ìƒì„± ë° ì„¤ì •</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">SecurityContext</span><span class="token plain"> context </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> securityContextHolderStrategy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createEmptyContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setAuthentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authentication</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">SecurityContextHolder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 4. SecurityContextRepositoryì— ì €ì¥ (HttpSessionì— ì €ì¥ë¨)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        securityContextRepository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">saveContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-sessionconfig---ì„¸ì…˜-ì •ì±…-ì„¤ì •">3) SessionConfig - ì„¸ì…˜ ì •ì±… ì„¤ì •<a href="#3-sessionconfig---ì„¸ì…˜-ì •ì±…-ì„¤ì •" class="hash-link" aria-label="3) SessionConfig - ì„¸ì…˜ ì •ì±… ì„¤ì •ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="3) SessionConfig - ì„¸ì…˜ ì •ì±… ì„¤ì •ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<p><strong>1) HttpSessionEventPublisher</strong></p>
<blockquote>
<p>ì„¸ì…˜ ìƒì„±/ì‚­ì œ ì´ë²¤íŠ¸ë¥¼ Spring Securityì— ì „ë‹¬</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">HttpSessionEventPublisher</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">httpSessionEventPublisher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">HttpSessionEventPublisher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sessionCreated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">HttpSessionEvent</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sessionCreated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sessionDestroyed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">HttpSessionEvent</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sessionDestroyed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>2) ì„œë¸”ë¦¿ ë¦¬ìŠ¤ë„ˆì— ë“±ë¡ (ì •ìƒ ë™ì‘ ë³´ì¥)</strong></p>
<blockquote>
<p><strong>(1)HttpSessionEventPublisher</strong>ì„ ServletListenerì— ë“±ë¡í•´ì•¼ ë¡œê·¸ì•„ì›ƒ ì‹œ SessionRegistryì—ì„œ ì„¸ì…˜ì´ ì œê±°ë¨
í•˜ì§€ ì•Šì„ ê²½ìš°, ì„¸ì…˜ì´ ëˆ„ì </p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">ServletListenerRegistrationBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">httpSessionEventPublisherRegistration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ServletListenerRegistrationBean</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">httpSessionEventPublisher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>3) SessionRegistry</strong></p>
<blockquote>
<p>ì„¸ì…˜ ë° ì‚¬ìš©ì ìƒíƒœ ê´€ë¦¬ í•µì‹¬ ì»´í¬ë„ŒíŠ¸</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">SessionRegistry</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sessionRegistry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SessionRegistryImpl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">registerNewSession</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> sessionId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Object</span><span class="token plain"> principal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">registerNewSession</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sessionId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> principal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">removeSessionInformation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> sessionId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">SessionInformation</span><span class="token plain"> info </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getSessionInformation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sessionId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">removeSessionInformation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sessionId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">extractPrincipalName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Object</span><span class="token plain"> principal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">principal </span><span class="token keyword" style="color:#00009f">instanceof</span><span class="token plain"> </span><span class="token class-name">User</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">User</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> principal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getEmail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> principal</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>4) SessionAuthenticationStrategy</strong></p>
<blockquote>
<p>ì¸ì¦ ì„±ê³µ ì‹œ ì‘ë™í•˜ëŠ” ì„¸ì…˜ ì •ì±…</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">SessionAuthenticationStrategy</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sessionAuthenticationStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">SessionRegistry</span><span class="token plain"> sessionRegistry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 3-1) ë™ì‹œ ë¡œê·¸ì¸ ê°œìˆ˜ ì œí•œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">ConcurrentSessionControlAuthenticationStrategy</span><span class="token plain"> concurrentControl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ConcurrentSessionControlAuthenticationStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sessionRegistry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        concurrentControl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setMaximumSessions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ë™ì¼ ê³„ì • 1ëª…ë§Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        concurrentControl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setExceptionIfMaximumExceeded</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ê¸°ì¡´ ì„¸ì…˜ ë§Œë£Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 3-2) ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì§€ (ì„¸ì…˜ ID ì¬ë°œê¸‰)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">SessionFixationProtectionStrategy</span><span class="token plain"> sessionFixation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SessionFixationProtectionStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sessionFixation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setMigrateSessionAttributes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 3-3) SessionRegistryì— ì„¸ì…˜ ë“±ë¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">RegisterSessionAuthenticationStrategy</span><span class="token plain"> registerSession </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">RegisterSessionAuthenticationStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sessionRegistry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 3ê°€ì§€ ì „ëµì„ Compositeë¡œ í†µí•©</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CompositeSessionAuthenticationStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            concurrentControl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sessionFixation</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            registerSession</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-securityfilterchain-ì„¤ì •">4) SecurityFilterChain ì„¤ì •<a href="#4-securityfilterchain-ì„¤ì •" class="hash-link" aria-label="4) SecurityFilterChain ì„¤ì •ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="4) SecurityFilterChain ì„¤ì •ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<blockquote>
<p>ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” &quot;ë¡œê·¸ì¸ ì‹œ ë”± í•œ ë²ˆ ì‹¤í–‰&quot;ë˜ì–´ &quot;ì„¸ì…˜ ìƒì„± ë° ì „ëµ ìˆ˜ë™ í˜¸ì¶œ&quot;í•¨
í•„í„°ëŠ” &quot;ë¡œê·¸ì¸ ì´í›„ API&quot;ì— &quot;ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦ ë° ì •ì±… ë‹´ë‹¹&quot;</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">SecurityFilterChain</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">securityFilterChain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">HttpSecurity</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">cors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cors </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> cors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">configurationSource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">corsConfigurationSource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">csrf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">csrf </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> csrf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">disable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// REST APIëŠ” CSRF ë¶ˆí•„ìš”</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// SecurityContext ì €ì¥ ë°©ì‹ ì„¤ì •</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">securityContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">securityContextRepository</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">securityContextRepository</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">requireExplicitSave</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ëª…ì‹œì  ì €ì¥ (Controllerì—ì„œ ìˆ˜ë™ ì €ì¥)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ì„¸ì…˜ ê´€ë¦¬ ì„¤ì •</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sessionManagement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">session </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sessionFixation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">changeSessionId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì§€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sessionCreationPolicy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">IF_REQUIRED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">maximumSessions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ë™ì¼ ê³„ì • 1ëª…ë§Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">maxSessionsPreventsLogin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ê¸°ì¡´ ì„¸ì…˜ ë§Œë£Œ ë°©ì‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sessionRegistry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">sessionRegistry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">expiredSessionStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">customSessionExpiredStrategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ë§Œë£Œ ì‹œ ì²˜ë¦¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ì˜ˆì™¸ ì²˜ë¦¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">exceptionHandling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ex </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">authenticationEntryPoint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">authenticationDeniedHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 401</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">accessDeniedHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">authorizationDeniedHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 403</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ì»¤ìŠ¤í…€ í•„í„° ì¶”ê°€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addFilterBefore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">sessionExpiredFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">SecurityContextPersistenceFilter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addFilterBefore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">improvedLogoutFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">LogoutFilter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>ì£¼ìš” ì„¤ì • ì„¤ëª…</strong></p>
<ul>
<li class="">
<p><strong>requireExplicitSave</strong></p>
<ul>
<li class="">ê¸°ë³¸ê°’(false)ì€ SecurityContextPersistenceFilterê°€ ìë™ ì €ì¥</li>
<li class="">trueë¡œ ì„¤ì • ì‹œ Controllerì—ì„œ ìˆ˜ë™ìœ¼ë¡œ saveContext() í˜¸ì¶œ í•„ìš”</li>
<li class="">trueë¡œ ë³€ê²½í•˜ì§€ ì•Šìœ¼ë©´, SecurityContextê°€ ë‘ ë²ˆ ì €ì¥ë¨</li>
</ul>
</li>
<li class="">
<p><strong>sessionFixation().changeSessionId()</strong></p>
<ul>
<li class="">ì„¸ì…˜ ê³ ì • ê³µê²©(Session Fixation) ë°©ì§€</li>
<li class="">ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì„¸ì…˜ IDë¥¼ ìƒˆë¡œ ë°œê¸‰í•˜ì—¬ ê³µê²©ìê°€ íƒˆì·¨í•œ ì„¸ì…˜ ID ë¬´íš¨í™”</li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-ë™ì‘-ê²€ì¦">4. ë™ì‘ ê²€ì¦<a href="#4-ë™ì‘-ê²€ì¦" class="hash-link" aria-label="4. ë™ì‘ ê²€ì¦ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="4. ë™ì‘ ê²€ì¦ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h2>
<p><strong>1) ì •ìƒ ë¡œê·¸ì¸</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /api/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;email&quot;: &quot;user@example.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;password&quot;: &quot;password123&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â†’ 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;status&quot;: &quot;SUCCESS&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;user&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;email&quot;: &quot;user@example.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;CUSTOMER&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>2) 5íšŒ ì‹¤íŒ¨ â†’ ê³„ì • ì ê¹€</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1~4íšŒ ì‹¤íŒ¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â†’ 400 Bad Request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;error&quot;: &quot;ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. (ë‚¨ì€ ì‹œë„: 4íšŒ)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 5íšŒ ì‹¤íŒ¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â†’ 423 Locked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;error&quot;: &quot;5íšŒ ì‹¤íŒ¨ë¡œ ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>3) ì²« ë¡œê·¸ì¸</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /api/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;email&quot;: &quot;newuser@example.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;password&quot;: &quot;temp123&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â†’ 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;status&quot;: &quot;FIRST_LOGIN&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;message&quot;: &quot;ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>4) ì¤‘ë³µ ë¡œê·¸ì¸ ì œì–´</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ì‚¬ìš©ì A: ë¡œê·¸ì¸ ì„±ê³µ (Session ID: abc123)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ì‚¬ìš©ì B: ê°™ì€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ì‹œë„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â†’ ì‚¬ìš©ì Aì˜ ì„¸ì…˜ì´ ë§Œë£Œë¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â†’ ì‚¬ìš©ì Aê°€ API í˜¸ì¶œ ì‹œ 401 Unauthorized ì‘ë‹µ</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-ì •ë¦¬">5. ì •ë¦¬<a href="#5-ì •ë¦¬" class="hash-link" aria-label="5. ì •ë¦¬ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="5. ì •ë¦¬ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="í•µì‹¬-ìš”ì•½">í•µì‹¬ ìš”ì•½<a href="#í•µì‹¬-ìš”ì•½" class="hash-link" aria-label="í•µì‹¬ ìš”ì•½ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="í•µì‹¬ ìš”ì•½ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<blockquote>
<p>JSON ê¸°ë°˜ ë¡œê·¸ì¸ + ê³„ì • ì ê¸ˆ + ì²« ë¡œê·¸ì¸ ì²´í¬ + ROLEë³„ ì‘ë‹µ<br>
<!-- -->ì´ 4ê°€ì§€ë¥¼ FormLogin í•„í„°ì—ì„œ ì²˜ë¦¬í•˜ê¸°ëŠ” ë„ˆë¬´ ë³µì¡í•´ìŠµë‹ˆë‹¤.</p>
</blockquote>
<p><strong>Controller ë°©ì‹ìœ¼ë¡œ ì „í™˜í•œ í›„:</strong></p>
<ul>
<li class="">ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ Service ë ˆì´ì–´ì— ëª…í™•íˆ ë¶„ë¦¬ë¨</li>
<li class="">Spring Securityì˜ ì„¸ì…˜ ì •ì±…ì€ ê·¸ëŒ€ë¡œ í™œìš©</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="íŠ¸ë ˆì´ë“œì˜¤í”„">íŠ¸ë ˆì´ë“œì˜¤í”„<a href="#íŠ¸ë ˆì´ë“œì˜¤í”„" class="hash-link" aria-label="íŠ¸ë ˆì´ë“œì˜¤í”„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="íŠ¸ë ˆì´ë“œì˜¤í”„ì— ëŒ€í•œ ì§ì ‘ ë§í¬" translate="no">â€‹</a></h3>
<ul>
<li class="">
<p><strong>ì¥ì :</strong></p>
<ul>
<li class="">ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ììœ ë„ ë†’ìŒ</li>
<li class="">ì½”ë“œ ê°€ë…ì„± ì¢‹ìŒ</li>
</ul>
</li>
<li class="">
<p><strong>ë‹¨ì :</strong></p>
<ul>
<li class="">Spring Securityì˜ &quot;ìë™í™”&quot;ë¥¼ í¬ê¸°</li>
<li class=""><code>SessionAuthenticationStrategy</code> ìˆ˜ë™ í˜¸ì¶œ í•„ìš”</li>
<li class=""><code>SecurityContext</code> ìˆ˜ë™ ì €ì¥ í•„ìš”</li>
</ul>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ íƒìƒ‰"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/jpa-mybatis-hybrid-strategy"><div class="pagination-nav__sublabel">ì´ì „ ê²Œì‹œë¬¼</div><div class="pagination-nav__label">ë³µì¡í•œ ê²€ìƒ‰ ì¿¼ë¦¬, JPA vs MyBatis ì„±ëŠ¥ ë¹„êµì™€ í•˜ì´ë¸Œë¦¬ë“œ ì „ëµ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/index"><div class="pagination-nav__sublabel">ë‹¤ìŒ ê²Œì‹œë¬¼</div><div class="pagination-nav__label">ê¸°ë¡ ë¸”ë¡œê·¸</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-ì™œ-ì»¤ìŠ¤í…€-ì„¸ì…˜-ì¸ì¦" class="table-of-contents__link toc-highlight">1. ì™œ ì»¤ìŠ¤í…€ ì„¸ì…˜ ì¸ì¦?</a><ul><li><a href="#í”„ë¡œì íŠ¸-ìš”êµ¬ì‚¬í•­" class="table-of-contents__link toc-highlight">í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­</a></li><li><a href="#í‘œì¤€-formloginì˜-í•œê³„" class="table-of-contents__link toc-highlight">í‘œì¤€ FormLoginì˜ í•œê³„</a></li><li><a href="#í•´ê²°-ë°©ì•ˆ-controller--sessionauthenticationstrategy-ì¡°í•©" class="table-of-contents__link toc-highlight">í•´ê²° ë°©ì•ˆ: Controller + SessionAuthenticationStrategy ì¡°í•©</a></li></ul></li><li><a href="#2-ì¸ì¦-êµ¬í˜„" class="table-of-contents__link toc-highlight">2. ì¸ì¦ êµ¬í˜„</a><ul><li><a href="#ì „ì²´-ì¸ì¦-í”Œë¡œìš°" class="table-of-contents__link toc-highlight">ì „ì²´ ì¸ì¦ í”Œë¡œìš°</a></li><li><a href="#ë‹¨ê³„ë³„-ì„¤ëª…" class="table-of-contents__link toc-highlight">ë‹¨ê³„ë³„ ì„¤ëª…</a></li></ul></li><li><a href="#3-í•µì‹¬-ì»´í¬ë„ŒíŠ¸-êµ¬í˜„" class="table-of-contents__link toc-highlight">3. í•µì‹¬ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„</a><ul><li><a href="#ê°-ì»´í¬ë„ŒíŠ¸ì˜-ì—­í• " class="table-of-contents__link toc-highlight"><strong>ê° ì»´í¬ë„ŒíŠ¸ì˜ ì—­í• </strong></a></li><li><a href="#1-user-entity" class="table-of-contents__link toc-highlight">1) User Entity</a></li><li><a href="#2-loginservice" class="table-of-contents__link toc-highlight">2) LoginService</a></li><li><a href="#3-sessionconfig---ì„¸ì…˜-ì •ì±…-ì„¤ì •" class="table-of-contents__link toc-highlight">3) SessionConfig - ì„¸ì…˜ ì •ì±… ì„¤ì •</a></li><li><a href="#4-securityfilterchain-ì„¤ì •" class="table-of-contents__link toc-highlight">4) SecurityFilterChain ì„¤ì •</a></li></ul></li><li><a href="#4-ë™ì‘-ê²€ì¦" class="table-of-contents__link toc-highlight">4. ë™ì‘ ê²€ì¦</a></li><li><a href="#5-ì •ë¦¬" class="table-of-contents__link toc-highlight">5. ì •ë¦¬</a><ul><li><a href="#í•µì‹¬-ìš”ì•½" class="table-of-contents__link toc-highlight">í•µì‹¬ ìš”ì•½</a></li><li><a href="#íŠ¸ë ˆì´ë“œì˜¤í”„" class="table-of-contents__link toc-highlight">íŠ¸ë ˆì´ë“œì˜¤í”„</a></li></ul></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 Kang-hee. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>