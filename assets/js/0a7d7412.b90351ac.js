"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[1755],{5568(e,t,r){r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"projects/security-ticket/troubleshooting/code_JPA-Specification","title":"code_JPA-Specification","description":"JPA-Specification","source":"@site/docs/projects/security-ticket/troubleshooting/code_JPA-Specification.md","sourceDirName":"projects/security-ticket/troubleshooting","slug":"/projects/security-ticket/troubleshooting/code_JPA-Specification","permalink":"/docs/projects/security-ticket/troubleshooting/code_JPA-Specification","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\ucee4\uc2a4\ud140 \uc138\uc158 \uc778\uc99d \uad6c\ud604","permalink":"/docs/projects/security-ticket/troubleshooting/custom-session-auth"},"next":{"title":"code_LoginService","permalink":"/docs/projects/security-ticket/troubleshooting/code_LoginService"}}');var n=r(4848),o=r(8453);const a={},c=void 0,s={},l=[{value:"JPA-Specification",id:"jpa-specification",level:3}];function d(e){const t={code:"code",h3:"h3",pre:"pre",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h3,{id:"jpa-specification",children:"JPA-Specification"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-java",children:'public class UserSpecification {\r\n    public static Specification<User> filterClients(\r\n            LocalDate startDate,\r\n            LocalDate endDate,\r\n            String range,\r\n            String keyword) {\r\n\r\n        return (root, query, criteriaBuilder) -> {\r\n            List<Predicate> predicates = new ArrayList<>();\r\n\r\n            // Client\uac00 \uc788\ub294 User\ub9cc (\ud68c\uc6d0\ub9cc)\r\n            predicates.add(criteriaBuilder.isNotNull(root.get("client")));\r\n\r\n            // \ub0a0\uc9dc \ud544\ud130\r\n            if (startDate != null && endDate != null) {\r\n                LocalDateTime startDateTime = startDate.atStartOfDay();\r\n                LocalDateTime endDateTime = endDate.plusDays(1).atStartOfDay();\r\n                predicates.add(criteriaBuilder.between(\r\n                        root.get("lastLoginAt"),\r\n                        startDateTime,\r\n                        endDateTime\r\n                ));\r\n            }\r\n\r\n            // \ud0a4\uc6cc\ub4dc \uac80\uc0c9\r\n            if (keyword != null && !keyword.isEmpty()) {\r\n                if ("all".equals(range)) {\r\n                    Predicate emailLike = criteriaBuilder.like(\r\n                            root.get("email"), "%" + keyword + "%");\r\n                    Predicate nameLike = criteriaBuilder.like(\r\n                            root.get("name"), "%" + keyword + "%");\r\n                    Predicate deptLike = criteriaBuilder.like(\r\n                            root.get("department"), "%" + keyword + "%");\r\n\r\n                    // Company name \uac80\uc0c9\uc744 \uc704\ud55c Join\r\n                    Join<Object, Object> clientJoin = root.join("client");\r\n                    Join<Object, Object> companyJoin = clientJoin.join("company");\r\n                    Predicate companyLike = criteriaBuilder.like(\r\n                            companyJoin.get("name"), "%" + keyword + "%");\r\n\r\n                    predicates.add(criteriaBuilder.or(\r\n                            emailLike, nameLike, deptLike, companyLike));\r\n\r\n                } else if ("email".equals(range)) {\r\n                    predicates.add(criteriaBuilder.like(\r\n                            root.get("email"), "%" + keyword + "%"));\r\n                } else if ("name".equals(range)) {\r\n                    predicates.add(criteriaBuilder.like(\r\n                            root.get("name"), "%" + keyword + "%"));\r\n                } else if ("department".equals(range)) {\r\n                    predicates.add(criteriaBuilder.like(\r\n                            root.get("department"), "%" + keyword + "%"));\r\n                } else if ("companyName".equals(range)) {\r\n                    Join<Object, Object> clientJoin = root.join("client");\r\n                    Join<Object, Object> companyJoin = clientJoin.join("company");\r\n                    predicates.add(criteriaBuilder.like(\r\n                            companyJoin.get("name"), "%" + keyword + "%"));\r\n                }\r\n            }\r\n\r\n            return criteriaBuilder.and(predicates.toArray(new Predicate[0]));\r\n        };\r\n    }\r\n}\n'})})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453(e,t,r){r.d(t,{R:()=>a,x:()=>c});var i=r(6540);const n={},o=i.createContext(n);function a(e){const t=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);