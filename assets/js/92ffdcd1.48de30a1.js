"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[48],{7768(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"projects/security-ticket/troubleshooting/code_SessionConfig","title":"code_SessionConfig","description":"/config/SessionConfig","source":"@site/docs/projects/security-ticket/troubleshooting/code_SessionConfig.md","sourceDirName":"projects/security-ticket/troubleshooting","slug":"/projects/security-ticket/troubleshooting/code_SessionConfig","permalink":"/docs/projects/security-ticket/troubleshooting/code_SessionConfig","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"code_Native-Query","permalink":"/docs/projects/security-ticket/troubleshooting/code_Native-Query"},"next":{"title":"ReadyBerry","permalink":"/docs/projects/readyberry/"}}');var s=t(4848),i=t(8453);const o={},c=void 0,a={},u=[{value:"/config/SessionConfig",id:"configsessionconfig",level:3}];function g(e){const n={code:"code",h3:"h3",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h3,{id:"configsessionconfig",children:"/config/SessionConfig"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Configuration\r\npublic class SessionConfig {\r\n\t...\r\n    @Bean\r\n    public HttpSessionEventPublisher httpSessionEventPublisher() {\r\n        return new HttpSessionEventPublisher() {\r\n            @Override\r\n            public void sessionCreated(HttpSessionEvent event) {\r\n                String sessionId = event.getSession().getId();\r\n                event.getSession().setMaxInactiveInterval(sessionTimeout);\r\n            }\r\n\r\n            @Override\r\n            public void sessionDestroyed(HttpSessionEvent event) {\r\n                String sessionId = event.getSession().getId();\r\n            }\r\n        };\r\n    }\r\n\r\n    /**\r\n     * HttpSessionEventPublisher \ub4f1\ub85d (SessionRegistry \ub3d9\uc791 \ubcf4\uc7a5)\r\n     */\r\n    @Bean\r\n    public ServletListenerRegistrationBean<HttpSessionEventPublisher> httpSessionEventPublisherRegistration() {\r\n        return new ServletListenerRegistrationBean<>(httpSessionEventPublisher());\r\n    }\r\n\r\n    /**\r\n     * \ud65c\uc131 \uc138\uc158 \ucd94\uc801 \ubc0f \uad00\ub9ac\r\n     */\r\n    @Bean\r\n    public SessionRegistry sessionRegistry() {\r\n        return new SessionRegistryImpl() {\r\n            @Override\r\n            public void registerNewSession(String sessionId, Object principal) {\r\n                super.registerNewSession(sessionId, principal);\r\n            }\r\n\r\n            @Override\r\n            public void removeSessionInformation(String sessionId) {\r\n                super.removeSessionInformation(sessionId);\r\n            }\r\n\r\n            private String extractPrincipalName(Object principal) {\r\n                if (principal instanceof User user) {\r\n                    return user.getEmail();\r\n                }\r\n                return principal != null ? principal.toString() : "anonymous";\r\n            }\r\n        };\r\n    }\r\n\r\n    /**\r\n     * \ubcf5\ud569 \uc138\uc158 \uc778\uc99d \uc804\ub7b5 \uc124\uc815\r\n     * - \uc911\ubcf5 \ub85c\uadf8\uc778 \uc81c\uc5b4\r\n     * - \uc138\uc158 \uace0\uc815 \uacf5\uaca9 \ubc29\uc9c0\r\n     * - \uc138\uc158 \ub808\uc9c0\uc2a4\ud2b8\ub9ac \ub4f1\ub85d\r\n     */\r\n    @Bean\r\n    public SessionAuthenticationStrategy sessionAuthenticationStrategy(SessionRegistry sessionRegistry) {\r\n        // \uc911\ubcf5 \ub85c\uadf8\uc778 \uc81c\uc5b4\r\n        ConcurrentSessionControlAuthenticationStrategy concurrentStrategy =\r\n                new ConcurrentSessionControlAuthenticationStrategy(sessionRegistry);\r\n        concurrentStrategy.setMaximumSessions(maxSessionsPerUser);\r\n        concurrentStrategy.setExceptionIfMaximumExceeded(preventLoginWhenExceeded);\r\n\r\n        // \uc138\uc158 \uace0\uc815 \uacf5\uaca9 \ubc29\uc9c0\r\n        SessionFixationProtectionStrategy fixationStrategy = new SessionFixationProtectionStrategy();\r\n\r\n        // \uc138\uc158 \ub4f1\ub85d\r\n        RegisterSessionAuthenticationStrategy registerStrategy =\r\n                new RegisterSessionAuthenticationStrategy(sessionRegistry);\r\n\r\n        // \uc804\ub7b5 \ud1b5\ud569\r\n        CompositeSessionAuthenticationStrategy compositeStrategy = new CompositeSessionAuthenticationStrategy(\r\n                List.of(\r\n                        concurrentStrategy,\r\n                        fixationStrategy,\r\n                        registerStrategy\r\n                )\r\n        );\r\n        return compositeStrategy;\r\n    }\r\n}\n'})})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>c});var r=t(6540);const s={},i=r.createContext(s);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);